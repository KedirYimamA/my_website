#################################################
##--------Author: Kedir Ahmed------------########
##--------Project: Central obesity global---#####
#################################################
rm(list = ls())
##################################################
####loading the library and opening the datasets##
#loading relevant packages
library(lme4)
library(emmeans)
library(tidyverse)
library(mice)
library(gt)
library(officer)
library(broom.mixed)
# Load the datasets
baseline <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Baseline_241015/Clean_baseline_data.dta") %>%
mutate(across(where(is.labelled), as_factor)) #%>%
library(lme4)
library(emmeans)
library(tidyverse)
library(mice)
install.packages("mice")
#################################################
##--------Author: Kedir Ahmed------------########
##--------Project: Central obesity global---#####
#################################################
rm(list = ls())
##################################################
####loading the library and opening the datasets##
#loading relevant packages
library(lme4)
library(emmeans)
library(tidyverse)
library(mice)
library(haven)
library(gtsummary)
library(gt)
library(officer)
library(broom.mixed)
# Load the datasets
baseline <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Baseline_241015/Clean_baseline_data.dta") %>%
mutate(across(where(is.labelled), as_factor)) #%>%
time1 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup 1/Followup1_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
time2 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup 2/Followup2_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
time2 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup 2/Followup2_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
time2 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup2/Followup2_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
#################################################
##--------Author: Kedir Ahmed------------########
##--------Project: FEM program analsysi-----#####
#################################################
rm(list = ls())
##################################################
####loading the library and opening the datasets##
#loading relevant packages
library(lme4)
library(emmeans)
library(tidyverse)
library(mice)
library(haven)
library(gtsummary)
library(gt)
library(officer)
library(broom.mixed)
# Load the datasets
baseline <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Baseline_241015/Clean_baseline_data.dta") %>%
mutate(across(where(is.labelled), as_factor)) #%>%
#filter(gender != "Male")  # Exclude males
time1 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup 1/Followup1_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
time2 <- read_dta("C:/Users/User/Dropbox/RHRI documents/Julaine/FEM project/Followup2/Followup2_clean_data.dta") %>%
mutate(across(where(is.labelled), as_factor))
#duplicate was found in time 2
time2 <- time2 %>% distinct(unique_id, .keep_all = TRUE)
head(baseline)
head(time1)
head(time2)
baseline <- data.frame(baseline)
categorical_vars <- c("gender", "country_born", "First_Nations", "maritalstat", "edustat")
# Ensure 'treatment' is a factor with levels 'Intervention' and 'Waitlist'
baseline$treatment <- factor(baseline$treatment, levels = c("Intervention", "Waitlist"))
# Create summary table for only the specific categorical variables, including 'treatment'
summary_table <- tbl_summary(
baseline[, c(categorical_vars, "treatment")],  # Include 'treatment' in the selection
by = "treatment",                             # Group by the 'treatment' column
statistic = list(all_categorical() ~ "{n} ({p}%)"),  # Display count and percentage
missing = "no"                                # Exclude missing values
)
# Create summary table for only the specific categorical variables, without 'treatment'
summary_table_total <- tbl_summary(
baseline[, c(categorical_vars)],  # Exclude 'treatment' from the selection
statistic = list(all_categorical() ~ "{n} ({p}%)"),  # Display count and percentage
missing = "no"                                # Exclude missing values
)
# Convert summary tables to data frames for easier manipulation
summary_df <- as_tibble(summary_table)
summary_df_total <- as_tibble(summary_table_total)
# Merge the two summary tables by row names to add the total column after Intervention and Waitlist
merged_summary <- bind_cols(summary_df, summary_df_total[, -1])  # Remove the first column (variable names) from the total table
# Ensure the columns are aligned and there are no NA values in the merged data
merged_summary <- merged_summary %>%
mutate(across(everything(), ~ replace(., is.na(.), "")))  # Replace NA values with "0 (0%)" to avoid missing data in the output
# Display the merged summary table inline
merged_summary %>%
gt() %>%
gtsave("merged_summary_table.html")
merged_summary
